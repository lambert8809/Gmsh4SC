#include <iostream>
#include <sstream>   // important for read .U file and write post view file
#include <fstream>   // important for read .U file and write post view file
#include <stdio.h>
#include <stdlib.h>
#include <vector>
#include <istream>
#include <string>
#include "strcMesh.h"
 

void new_struc_mesh(std::string name, std::vector<std::string>& read, std::string r1, std::vector<std::string>& mat){
  std::ofstream struMesh;
  struMesh.open(name.c_str());
  for (int i = 0; i < read.size(); i++){
    struMesh << read[i] << "\n";
  }
  double h1 = 1;
  double w = 1;
  int zero = 0;
  double lc = 0.02;
  struMesh << "\n";
  struMesh << "// Generate structuced mesh ;\n"
	      << "r = " << r1 << ";\n\n"
	      << "Point(1) = {" << -h1 / 2 << ", " << -w / 2 << ", 0, "<< lc << "};\n"
	      << "Point(2) = {" << h1 / 2 << ", " << -w / 2 << ", 0, " << lc << "};\n"
	      << "Point(3) = {" << h1 / 2 << ", " << w / 2 << ", 0, " << lc << "};\n"
	      << "Point(4) = {" << -h1 / 2 << ", " << w / 2 << ", 0, " << lc << "};\n"
	      << "Point(5) = {" << -h1/2 << ", " << zero << ", 0, " << lc << "};\n"
	      << "Point(6) = {" << zero << ", " << -w/2 << ", 0, " << lc << "};\n"
	      << "Point(7) = {" << h1/2 << ", " << zero << ", 0, " << lc << "};\n"
	      << "Point(8) = {" << zero << ", " << w/2 << ", 0, " << lc << "};\n"
	      << "Point(9) = {" << zero << ", " << zero << ", 0, " << lc << "};\n"
	      << "Point(10) = {" << 0 << ", " << r1 << ", 0, " << lc << "};\n"
	      << "Point(11) = {" << 0 << ", -" << r1 << ", 0, " << lc << "};\n"
	      << "Point(12) = {" << r1 << ", " << zero << ", 0, " << lc << "};\n"
	      << "Point(13) = {-" << r1 << ", " << zero << ", 0, " << lc << "};\n"
	      << "Point(14) = {-r/2*Sqrt(2),r/2*Sqrt(2), 0, 0.02};\n"
	      << "Point(15) = {-r/2*Sqrt(2), -r/2*Sqrt(2), 0, 0.02}; \n"
	      << "Point(16) = {r/2*Sqrt(2), -r/2*Sqrt(2), 0, 0.02}; \n"
	      << "Point(17) = {r/2*Sqrt(2), r/2*Sqrt(2), 0, 0.02}; \n"
	      << "Point(18) = {-r/2*Sqrt(2)/2, r/2*Sqrt(2)/2, 0, 0.02}; \n"
	      << "Point(19) = {-r/2*Sqrt(2)/2, -r/2*Sqrt(2)/2, 0, 0.02}; \n"
	      << "Point(20) = {r/2*Sqrt(2)/2, -r/2*Sqrt(2)/2, 0, 0.02}; \n"
	      << "Point(21) = {r/2*Sqrt(2)/2, r/2*Sqrt(2)/2, 0, 0.02}; \n"
	      << "Point(22) = {-r/2*Sqrt(2)/2, 0, 0, 0.02}; \n"
	      << "Point(23) = {0, -r/2*Sqrt(2)/2, 0, 0.02}; \n"
	      << "Point(24) = {r/2*Sqrt(2)/2, 0, 0, 0.02}; \n"
	      << "Point(25) = {0, r/2*Sqrt(2)/2, 0, 0.02}; \n"
	      << "Line(3) = {1, 6}; \n"
	      << "Line(4) = {6, 2}; \n"
	      << "Line(5) = {2, 7}; \n"
	      << "Line(6) = {7, 3}; \n"
	      << "Line(7) = {3, 8}; \n"
	      << "Line(8) = {8, 4}; \n"
	      << "Line(9) = {4, 5}; \n"
	      << "Line(10) = {5, 1}; \n"
	      << "Line(11) = {18, 22}; \n"
	      << "Line(12) = {22, 19}; \n"
	      << "Line(13) = {19, 23}; \n"
	      << "Line(14) = {23, 20}; \n"
	      << "Line(15) = {20, 24}; \n"
	      << "Line(16) = {24, 21}; \n"
	      << "Line(17) = {21, 25}; \n"
	      << "Line(18) = {25, 18}; \n"
	<< "Line(19) = {18, 14}; \n"
	<< "Line(20) = {14, 4}; \n"
	<< "Line(21) = {22, 13}; \n"
	<< "Line(22) = {13, 5}; \n"
	<< "Line(23) = {19, 15}; \n"
	<< "Line(24) = {15, 1}; \n"
	<< "Line(25) = {23, 11}; \n"
	<< "Line(26) = {11, 6}; \n"
	<< "Line(27) = {20, 16}; \n"
	<< "Line(28) = {16, 2}; \n"
	<< "Line(29) = {24, 12}; \n"
	<< "Line(30) = {12, 7}; \n"
	<< "Line(31) = {21, 17}; \n"
	<< "Line(32) = {17, 3}; \n"
	<< "Line(33) = {25, 10}; \n"
	<< "Line(34) = {10, 8}; \n"
	<< "Circle(35) = {10, 9, 14}; \n"
	<< "Circle(36) = {14, 9, 13}; \n"
	<< "Circle(37) = {13, 9, 15}; \n"
	<< "Circle(38) = {15, 9, 11}; \n"
	<< "Circle(39) = {11, 9, 16}; \n"
	<< "Circle(40) = {16, 9, 12}; \n"
	<< "Circle(41) = {12, 9, 17}; \n"
	<< "Circle(42) = {17, 9, 10}; \n"
	<< "Line Loop(43) = {8, -20, -35, 34}; \n"
	<< "Plane Surface(44) = {43}; \n"
	<< "Line Loop(45) = {9, -22, -36, 20}; \n"
	<< "Plane Surface(46) = {45}; \n"
	<< "Line Loop(47) = {10, -24, -37, 22}; \n"
	<< "Plane Surface(48) = {47}; \n"
	<< "Line Loop(49) = {3, -26, -38, 24}; \n"
	<< "Plane Surface(50) = {49}; \n"
	<< "Line Loop(51) = {4, -28, -39, 26}; \n"
	<< "Plane Surface(52) = {51}; \n"
	<< "Line Loop(53) = {5, -30, -40, 28}; \n"
	<< "Plane Surface(54) = {53}; \n"
	<< "Line Loop(55) = {6, -32, -41, 30}; \n"
	<< "Plane Surface(56) = {55}; \n"
	<< "Line Loop(57) = {7, -34, -42, 32}; \n"
	<< "Plane Surface(58) = {57}; \n"
	<< "Line Loop(59) = {35, -19, -18, 33}; \n"
	<< "Plane Surface(60) = {59}; \n"
	<< "Line Loop(61) = {36, -21, -11, 19}; \n"
	<< "Plane Surface(62) = {61}; \n"
	<< "Line Loop(63) = {37, -23, -12, 21}; \n"
	<< "Plane Surface(64) = {63}; \n"
	<< "Line Loop(65) = {38, -25, -13, 23}; \n"
	<< "Plane Surface(66) = {65}; \n"
	<< "Line Loop(67) = {39, -27, -14, 25}; \n"
	<< "Plane Surface(68) = {67}; \n"
	<< "Line Loop(69) = {40, -29, -15, 27}; \n"
	<< "Plane Surface(70) = {69}; \n"
	<< "Line Loop(71) = {41, -31, -16, 29}; \n"
	<< "Plane Surface(72) = {71}; \n"
	<< "Line Loop(73) = {42, -33, -17, 31}; \n"
	<< "Plane Surface(74) = {73}; \n"
	<< "Line(77) = {9, 22}; \n"
	<< "Line(78) = {9, 25}; \n"
	<< "Line(79) = {9, 23}; \n"
	<< "Line(80) = {9, 24}; \n"
	<< "Line Loop(81) = {18, 11, -77, 78}; \n"
	<< "Plane Surface(82) = {81}; \n"
	<< "Line Loop(83) = {17, -78, 80, 16}; \n"
	<< "Plane Surface(84) = {83}; \n"
	<< "Line Loop(85) = {12, 13, -79, 77}; \n"
	<< "Plane Surface(86) = {85}; \n"
	<< "Line Loop(87) = {14, 15, -80, 79}; \n"
	      << "Plane Surface(88) = {87}; \n"
	      << "Physical Surface(" << mat[0] << ") = {82, 86, 88, 84, 60, 62, 64, 66, 68, 70, 72, 74}; \n"
	      << " Physical Surface(" << mat[1] << ") = {44, 46, 48, 50, 52, 54, 56, 58};\n"
	      << "Transfinite Line { 9, 10, 3, 4, 5, 6, 7, 8, 35, 36, 37, 38, 39, 40, 41, 42, 18, 11, 12, 13, 14, 15, 16, 17, 78, 77, 79, 80} = 3 Using Progression 1; \n"
	   << "Transfinite Line {33, 19, 21, 23, 25, 27, 29, 31} = 4 Using Progression 1; \n"
	   << "Transfinite Line {20, 22, 24, 26, 28, 30, 32, 34} = 3 Using Progression 1; \n"
	<< "Transfinite Surface \"*\"; \n"
	<< "Recombine Surface \"*\"; \n"
	<< " \n";
  struMesh.close();
  
}
